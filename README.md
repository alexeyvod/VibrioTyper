# VibrioTyper

Программа для определения серогруппы у штаммов *Vibrio cholerae* на основе данных полногеномного секвенирования

## Содержание

* [Описание](#описание)
* [Алгоритм](#алгоритм)
* [Установка и запуск](#установка-и-запуск)
* [Входные данные](#входные-данные)
* [Работа с программой](#работа-с-программой)
* [Интерпретация результатов](#интерпретация-результатов)
* [Системные требования](#системные-требования)
* [Авторы](#авторы)
* [Обратная связь](#обратная-связь)

## Описание

Программа **VibrioTyper** предназначена для анализа данных полногеномного или фрагментарного секвенирования штаммов *Vibrio cholerae* с целью определения их серогруппы.

Программа разработана для специалистов, занимающихся молекулярно-генетическим анализом штаммов холерного вибриона, и может использоваться для мониторинга контаминации холерными вибрионами поверхностных водоемов.

## Алгоритм

Программа использует два подхода для определения серогруппы:

### 1. Определение серогруппы «по фрагментам»
- Основан на поиске коротких 40-нуклеотидных фрагментов, характерных для каждой серогруппы
- Процент соответствия рассчитывается по формуле: `100 × <количество выявленных фрагментов> / <количество фрагментов, характерных для данной серогруппы>`

### 2. Определение серогруппы «по генам»
- Основан на анализе всех возможных генов, входящих в О-кластер
- Использует «матрицу соответствия» с данными о наличии различных генов у разных серогрупп
- **Этап 1:** Поиск генов с помощью алгоритма Смита-Ватермана (минимум 80% соответствия)
- **Этап 2:** Определение серогруппы с максимально похожим набором генов

По умолчанию анализ проводится в режиме «по генам». Совпадение результатов обоих методов свидетельствует о высокой достоверности результата.

## Установка и запуск

Программа «Vibrio Typer» является кроссплатформенной и предназначена для работы в операционных системах Windows, Linux и MacOS. Предусмотрен как графический интерфейс для пакетного режима работы с выводом результатов в общей таблице, так и консольный вариант запуска из командной строки.

Программа доступна в двух вариантах:

- **Только исполняемый jar-файл**, предназначенный для работы в среде Windows, Linux и MacOS. Требуется предварительная установка Java Runtime Environment (JRE).
- **Полная версия с встроенной JRE**. (.7z архив) Предназначена для работы в среде Windows без необходимости установки дополнительных программ.

Для запуска программы достаточно распаковать скачанный архив с программой и запустить файл `VibrioTyper.bat` (.7z архив) или `VibrioTyper.jar`.


## Входные данные

В качестве исходных данных используются файлы в **FASTA-формате**, содержащие:
- Набор контигов (результат сборки *de novo* коротких ридов полногеномного секвенирования)
- Фрагмент генома, содержащий гены О-кластера

**Поддерживаемые расширения файлов:** `.fasta`, `.fa`

**Пакетная обработка:** Возможна обработка множества FASTA-файлов (каждый файл содержит геном одного штамма) с формированием сводной таблицы результатов.

## Работа с программой

### Интерфейс программы
1. **Заполните поле «Название работы»** — будет использовано в качестве имени файла с результатами
2. **Выберите режим анализа:**
   - По умолчанию: анализ «по генам»
   - При необходимости: установите флажок «Искать по фрагментам» для дополнительного анализа
3. **Нажмите кнопку «Выбрать геномы и начать анализ»**

### Процесс анализа
- Откроется диалоговое окно выбора файлов для анализа
- Анализ начинается автоматически после выбора файлов
- **Индикаторы прогресса:**
  - Тонкая полоса: прогресс текущего файла
  - Широкая полоса: общий прогресс при анализе нескольких геномов
- **Время анализа:** 5-120 минут для каждого штамма

## Интерпретация результатов

### Формат результатов
Результаты сохраняются в текстовом файле в папке с исходными FASTA-файлами. При импорте в текстовый редактор или электронные таблицы данные отображаются в табличном виде.

### Структура таблицы результатов
| Колонка | Описание |
|---------|----------|
| **Файл** | Имя анализируемого файла |
| **Серогруппа по фрагментам** | Результат анализа методом фрагментов |
| **Процент (фрагменты)** | Процент соответствия фрагментов |
| **Близкие типы** | Три наиболее близких серогруппы с процентами соответствия |
| **Серогруппа по генам** | Результат анализа методом генов |
| **Процент (гены)** | Процент соответствия генов |

### Интерпретация результатов
- **Высокая достоверность:** Совпадение серогруппы «по фрагментам» и «по генам»
- **«Не определено»:** Низкий процент соответствия, требуется дополнительный анализ
- **Близкие типы:** Помогают в оценке альтернативных вариантов серогруппирования

## Системные требования

- **Операционная система:** Windows
- **Формат входных данных:** FASTA (.fasta, .fa)
- **Дополнительное ПО:** Не требуется (автономное приложение)

## Авторы

- **Водопьянов А.С.**
- **Писанов Р.В.**
- **Водопьянов С.О.**

ФКУЗ Ростовский-на-Дону ордена Трудового Красного Знамени научно-исследовательский противочумный институт Роспотребнадзора

## Обратная связь

По всем вопросам, замечаниям и предложениям обращайтесь:

- **Email:** alexvod@gmail.com
- **Телефон:** 8(863)240-22-66
- **Почтовый адрес:** 344002, г. Ростов-на-Дону, ул. М. Горького, 117/40, Водопьянову Алексею Сергеевичу

---

© 2024 ФКУЗ Ростовский-на-Дону противочумный институт Роспотребнадзора